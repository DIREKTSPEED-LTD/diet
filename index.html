<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Diet by adamhalasz</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>Diet</h1>
        <p>A minimal plugin based http framework for node.js . Diet will save you development time and make your apps much more efficient.</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/adamhalasz/diet" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/adamhalasz/diet/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/adamhalasz/diet/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h1>
<a name="diet" class="anchor" href="#diet"><span class="octicon octicon-link"></span></a><strong>Diet</strong>
</h1>

<p>Diet is a beautiful, minimalistic, extensible HTTP framework for node.js. When you're code is on diet, your apps become skinny, fast, organized &amp; healthy!</p>

<h2>
<a name="what-does-diet-do" class="anchor" href="#what-does-diet-do"><span class="octicon octicon-link"></span></a><strong>What does diet do?</strong>
</h2>

<ul>
<li>Diet provides <strong>Plugins</strong> that extend your apps functionality.</li>
<li>Diet provides <strong>HTTP Routing</strong>.</li>
<li>Diet provides <strong>HTTP Domain Controlling</strong>.</li>
<li>Diet provides the <strong><code>$</code> signal argument</strong> that is a combination of the request and response objects. The signal argument holds key informations about the request, and some default functions, like <code>$.end()</code>, <code>$.url</code>, <code>$.query</code>, <code>$.body</code>, <code>$.headers</code>
</li>
<li>Diet ships with some powerful basic plugins: <code>sessions</code>,  <code>demands</code>, <code>diet-mysql</code>, <code>diet-accounts</code>, <code>diet-cookies</code>, <code>diet-mail</code>
</li>
</ul><h2>
<a name="hello-world" class="anchor" href="#hello-world"><span class="octicon octicon-link"></span></a><strong>Hello World!</strong>
</h2>

<div class="highlight highlight-js"><pre><span class="nx">$</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'diet'</span><span class="p">);</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">http</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="mi">8000</span><span class="p">);</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">'GET /'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span> <span class="nx">$</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">'Hello World!'</span><span class="p">);</span> <span class="p">})</span>
</pre></div>

<p>in just 3 lines.</p>

<h2>
<a name="install" class="anchor" href="#install"><span class="octicon octicon-link"></span></a><strong>Install</strong>
</h2>

<p><code>npm install diet</code></p>

<h2>
<a name="diet-plugins" class="anchor" href="#diet-plugins"><span class="octicon octicon-link"></span></a><strong>Diet Plugins</strong>
</h2>

<p>Plugins are middlewares that act as a bridge between modules and help write much more efficient Object Oriented code. Plugins are essentially regular node.js functions or modules that follow a standard based on diet's <code>$</code> <em>(signal)</em> argument.</p>

<h4>
<a name="the-3-types-of-plugins" class="anchor" href="#the-3-types-of-plugins"><span class="octicon octicon-link"></span></a><strong>The 3 Types of Plugins</strong>
</h4>

<p>Plugins may be all or at least one of these types:</p>

<ul>
<li>
<strong>Onload</strong> plugin</li>
<li>
<strong>Global</strong> plugin</li>
<li>
<strong>Local</strong> plugin</li>
</ul><h3>
<a name="onload-plugins" class="anchor" href="#onload-plugins"><span class="octicon octicon-link"></span></a><strong>Onload Plugins</strong>
</h3>

<p>Onload plugins <em>run code right away after the plugin was initialized</em>. The use cases of onload plugins are very handy when you want to alter the signal property globally, preprocess data, update caches, schedule/execute background tasks etc.</p>

<p><strong>An Example Plugin:</strong></p>

<div class="highlight highlight-js"><pre><span class="c1">// project/example.js</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">example</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span> 
    <span class="nx">$</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">'hello world!'</span><span class="p">;</span>
    <span class="nx">$</span><span class="p">.</span><span class="k">return</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>

<div class="highlight highlight-js"><pre><span class="c1">// project/index.js</span>
<span class="nx">$</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'diet'</span><span class="p">);</span>    
<span class="nx">$</span><span class="p">.</span><span class="nx">http</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="mi">8000</span><span class="p">);</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">plugin</span><span class="p">(</span><span class="s1">'example.js'</span><span class="p">);</span> <span class="c1">// pass a function as the second</span>
                        <span class="c1">// argument for an async callback</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span> <span class="c1">// -&gt; hello world!</span>
</pre></div>

<h3>
<a name="global-plugins" class="anchor" href="#global-plugins"><span class="octicon octicon-link"></span></a><strong>Global Plugins</strong>
</h3>

<p>Global plugins run on all incoming HTTP requests/routes. Global plugins can be handy when you need certain functionalities in all or a specific type of routes for example sessions &amp; static file handling.</p>

<p><strong>Example Plugin:</strong></p>

<div class="highlight highlight-js"><pre><span class="c1">// project/example.js</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'path'</span><span class="p">);</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">global</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">example</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">extension</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">extname</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">href</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">.</span><span class="k">return</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<div class="highlight highlight-js"><pre><span class="c1">// project/index.js</span>
<span class="nx">$</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'diet'</span><span class="p">);</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">http</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="mi">8000</span><span class="p">);</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">plugin</span><span class="p">(</span><span class="s1">'example.js'</span><span class="p">);</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">'get /'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">'Extension is '</span> <span class="o">+</span> <span class="nx">$</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">extension</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">'get /image.jpg'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">'Extension is '</span> <span class="o">+</span> <span class="nx">$</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">extension</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<pre><code>// terminal
curl 'http://localhost:8000/'
-&gt; Extension is undefined

curl 'http://localhost:8000/image.jpg'
-&gt; Extension is .jpg
</code></pre>

<h3>
<a name="local-plugins" class="anchor" href="#local-plugins"><span class="octicon octicon-link"></span></a><strong>Local Plugins</strong>
</h3>

<p>Local plugins run on specified routes. Local plugins are handy for organizing your code for optimization, so each plugin is required only when it is actually needed.</p>

<p><strong>Example Local Plugin as a Module:</strong></p>

<div class="highlight highlight-js"><pre><span class="c1">// project/example.js</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">local</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">person</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">'Adam'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
    <span class="nx">$</span><span class="p">.</span><span class="k">return</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<div class="highlight highlight-js"><pre><span class="c1">// project/index.js</span>
<span class="nx">$</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'diet'</span><span class="p">);</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">http</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="mi">8000</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">plugin</span><span class="p">(</span><span class="s1">'example.js'</span><span class="p">);</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">'get /'</span><span class="p">,</span> <span class="nx">person</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">'Hi I am '</span> <span class="o">+</span> <span class="nx">$</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">', '</span>  <span class="o">+</span> <span class="nx">$</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">age</span> <span class="o">+</span> <span class="s1">' old.'</span><span class="p">);</span>
    <span class="c1">// -&gt; Hi I am Adam, 20 years old.</span>
<span class="p">});</span>
</pre></div>

<p><strong>Example Local Plugin as a Function:</strong>
Local plugins can also be created as functions</p>

<div class="highlight highlight-js"><pre><span class="c1">// project/index.js</span>
<span class="nx">$</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'diet'</span><span class="p">);</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">http</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="mi">8000</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">person</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">'Adam'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
    <span class="nx">$</span><span class="p">.</span><span class="k">return</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">'GET /'</span><span class="p">,</span> <span class="nx">person</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">'Hi I am, '</span> <span class="o">+</span> <span class="nx">$</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">', '</span>  <span class="o">+</span> <span class="nx">$</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">age</span> <span class="o">+</span> <span class="s1">' old'</span><span class="p">);</span>
    <span class="c1">// -&gt; Hi I am Adam, 20 years old.</span>
<span class="p">});</span>
</pre></div>

<h3>
<a name="-signal" class="anchor" href="#-signal"><span class="octicon octicon-link"></span></a><strong>$ Signal</strong>
</h3>

<p>The signal is diet's namespace in node. There is a global signal variable used in the global context, and there is a signal argument which is used in the plugin's local context.</p>

<p><strong>Example</strong></p>

<div class="highlight highlight-js"><pre>    <span class="nx">$</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'diet'</span><span class="p">);</span>        <span class="c1">// &lt;-- global signal</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">http</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="mi">8000</span><span class="p">);</span>  <span class="c1">// &lt;-- using global signal in global scope</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">plugin</span><span class="p">(</span><span class="s1">'plugin_name'</span><span class="p">);</span>    

    <span class="nx">$</span><span class="p">(</span><span class="s1">'get / '</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>  <span class="c1">// &lt;-- signal argument</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">'hello world'</span><span class="p">);</span> <span class="c1">// &lt;-- using local signal in local scope</span>
    <span class="p">});</span>
</pre></div>

<p><strong>Global Signal Attributes</strong></p>

<div class="highlight highlight-js"><pre>    <span class="c1">// include a plugin</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">plugin</span><span class="p">(</span><span class="s1">'plugin_name'</span><span class="p">,</span> <span class="nx">optionl_async_function</span><span class="p">);</span>     

    <span class="c1">// enable debug mode. `false` by default.</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">debug</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> 

    <span class="c1">// path of your application. `process.cwd()` by default</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">path</span><span class="p">;</span>

    <span class="c1">// start accepting incoming http requests.</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">http</span><span class="p">(</span><span class="nx">hostname</span><span class="p">,</span> <span class="nx">port</span><span class="p">);</span>

    <span class="c1">// start accepting incoming https requests.</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">https</span><span class="p">(</span><span class="nx">hostname</span><span class="p">,</span> <span class="nx">port</span><span class="p">,</span> <span class="nx">certificates</span><span class="p">);</span>

    <span class="c1">// route http(s) requests</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">'get /path'</span><span class="p">,</span> <span class="nx">pluginA</span><span class="p">,</span> <span class="nx">pluginB</span> <span class="p">..,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
        <span class="p">...</span>
    <span class="p">});</span>
    <span class="c1">// first argument is the method and path. the method can be `get` or `post` followed by a space and the path.</span>
    <span class="c1">// 'get /page'</span>
    <span class="c1">// 'post /form'</span>
    <span class="c1">// the last argument is the ending function</span>
    <span class="c1">// any argument between the first and last is a local plugin</span>
</pre></div>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/adamhalasz">adamhalasz</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>